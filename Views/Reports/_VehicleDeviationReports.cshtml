@model IEnumerable<Fleet_WorkShop.Models.VehicleReport>
<script src="~/Scripts/jquery-3.3.1.js"></script>
<script src="~/Scripts/jquery.table2excel.js"></script>
<link href="~/ScriptsCss/Bindings.css" rel="stylesheet" />
<style>
    a {
        color: white;
        padding: 5px;
        margin: 10px;
        font-size: 14px;
        position: fixed;
        background-color: blueviolet;
    }
</style>
<script>
    $(function() {
        $('#btn').click(function () {
            $(".table").table2excel({
                exclude: ".noExl",
                name: "Vehicle  Deviation Report",
                filename: "Vehicle Deviation  Report" //do not include extension

            });
        })
    })
</script>
<h1 style="color: brown" align="center"><u>Vehicle Deviation Report</u></h1>
@Html.ActionLink("Back", "VehicleDeviationReport", new { id = 1 })
<button type="submit" id="btn" class="btn btn-default" style="background-color: blue; color: white; margin-left: 750px;margin-bottom: 20px">Export</button>
<br/>
<table class="table" align="center" style="width: 90%">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.JobcardId)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Workshop)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.District)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Vehicle)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.RepairDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DalivaryDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DateOfRepairCompletion)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DeviationTime)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Mechanic)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.ServiceIncharge)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Status)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Aggregate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Category)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.SubCategory)
        </th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.JobcardId)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Workshop)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.District)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Vehicle)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.RepairDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.DalivaryDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.DateOfRepairCompletion)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.DeviationTime)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Mechanic)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.ServiceIncharge)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Status)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Aggregate)
        </td>
       
        <td>
            @Html.DisplayFor(modelItem => item.Category)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.SubCategory)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Sparepart)
        </td>
    </tr>
}

</table>
<br/>
